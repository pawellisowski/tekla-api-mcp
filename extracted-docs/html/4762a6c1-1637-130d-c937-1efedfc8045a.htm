<html><head><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Operation.SortObjectsByPresentationOrder Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="SortObjectsByPresentationOrder method" /><meta name="System.Keywords" content="Operation.SortObjectsByPresentationOrder method" /><meta name="Microsoft.Help.F1" content="Tekla.Structures.Drawing.Operations.Operation.SortObjectsByPresentationOrder" /><meta name="Microsoft.Help.Id" content="M:Tekla.Structures.Drawing.Operations.Operation.SortObjectsByPresentationOrder(System.Collections.Generic.IList{Tekla.Structures.Drawing.DrawingObject},System.Collections.Generic.List{Tekla.Structures.Drawing.DrawingObject}@)" /><meta name="Description" content="Sorts objects relatively by presentation order from active drawing. Result is used to define relative drawing order of objects which are on top of each other. Last object from the list is drawn on top of all objects." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Tekla.Structures.Drawing.Operations" /><meta name="file" content="4762a6c1-1637-130d-c937-1efedfc8045a" /><meta name="guid" content="4762a6c1-1637-130d-c937-1efedfc8045a" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Tekla Open API Reference for Tekla Structures 2025</div><div class="pageBody"><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/logo.png" /></td><td class="titleColumn"><h1>Operation<span id="LSTC4878EE9_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4878EE9_0?cpp=::|nu=.");</script>SortObjectsByPresentationOrder Method </h1></td></tr></table><span class="introStyle"></span> <div class="summary">
             Sorts objects relatively by presentation order from active drawing. 
             Result is used to define relative drawing order of objects which are on top of each other. 
             Last object from the list is drawn on top of all objects.
             </div><p> </p>
    <strong>Namespace:</strong> 
   <a href="187b565a-8a45-7656-4b5b-dd1a7b740563.htm">Tekla.Structures.Drawing.Operations</a><br />
    <strong>Assembly:</strong>
   Tekla.Structures.Drawing (in Tekla.Structures.Drawing.dll) Version: 2025.0.0-alpha00048669+a99462f17964bc42624ada6e8d316db2d795d226<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID1RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','cs','1','2');return false;">C#</a></div><div id="ID0EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID0EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID0EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">bool</span> <span class="identifier">SortObjectsByPresentationOrder</span>(
	<span class="identifier">IList</span>&lt;<span class="identifier">DrawingObject</span>&gt; <span class="parameter">objects</span>,
	<span class="keyword">out</span> <span class="identifier">List</span>&lt;<span class="identifier">DrawingObject</span>&gt; <span class="parameter">objectsByPresentationOrder</span>
)</pre></div><div id="ID0EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">SortObjectsByPresentationOrder</span> ( 
	<span class="parameter">objects</span> <span class="keyword">As</span> <span class="identifier">IList</span>(<span class="keyword">Of</span> <span class="identifier">DrawingObject</span>),
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">objectsByPresentationOrder</span> <span class="keyword">As</span> <span class="identifier">List</span>(<span class="keyword">Of</span> <span class="identifier">DrawingObject</span>)
) <span class="keyword">As</span> <span class="identifier">Boolean</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EBCA");</script><h4 class="subHeading">Parameters</h4><dl><dt><span class="parameter">objects</span></dt><dd>Type: <span class="nolink">System.Collections.Generic<span id="LSTC4878EE9_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4878EE9_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IList</span><span id="LSTC4878EE9_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4878EE9_2?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="2056df24-dbe8-2cf2-1342-1a13dc0ccacd.htm">DrawingObject</a><span id="LSTC4878EE9_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4878EE9_3?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><br />Contains the objects layers are asked from</dd><dt><span class="parameter">objectsByPresentationOrder</span></dt><dd>Type: <span class="nolink">System.Collections.Generic<span id="LSTC4878EE9_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4878EE9_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>List</span><span id="LSTC4878EE9_5"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4878EE9_5?cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=(");</script><a href="2056df24-dbe8-2cf2-1342-1a13dc0ccacd.htm">DrawingObject</a><span id="LSTC4878EE9_6"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4878EE9_6?cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)");</script><span id="LSTC4878EE9_7"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC4878EE9_7?cpp=%");</script><br />Contains objects sorted by presentation order</dd></dl><h4 class="subHeading">Return Value</h4>Type: <span class="nolink">Boolean</span><br />True in case of success, false otherwise</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID2RBSection" class="collapsibleSection">
             The following example enumerates through all objects in all views and gets
             relative layers of objects.
             <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAADBA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAADBA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAADBA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">using</span> System;
<span class="highlight-keyword">using</span> System.Collections.Generic;
<span class="highlight-keyword">using</span> Tekla.Structures.Geometry3d;
<span class="highlight-keyword">using</span> Tekla.Structures.Drawing;
<span class="highlight-keyword">using</span> TSD = Tekla.Structures.Drawing;

<span class="highlight-keyword">class</span> Example
{
    <span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> MergeMarksTest()
    {
        DrawingHandler drawingHandler = <span class="highlight-keyword">new</span> DrawingHandler();

        <span class="highlight-keyword">var</span> drawing = drawingHandler.GetActiveDrawing();
        <span class="highlight-keyword">if</span> (drawing != <span class="highlight-keyword">null</span>)
        {
            List&lt;DrawingObject&gt; drawingObjects = <span class="highlight-keyword">new</span> List&lt;DrawingObject&gt;();

            <span class="highlight-comment">// pick marks to be merged</span>
            ViewBase pickedView;
            DrawingObject drawingObject;
            <span class="highlight-keyword">var</span> picker = drawingHandler.GetPicker();
            <span class="highlight-keyword">bool</span> continuePicking = <span class="highlight-keyword">true</span>;
            <span class="highlight-keyword">while</span> (continuePicking)
            {
                <span class="highlight-keyword">try</span>
                {
                    <span class="highlight-keyword">var</span> message = <span class="highlight-literal">"Pick object "</span> + (drawingObjects.Count + <span class="highlight-number">1</span>).ToString() + <span class="highlight-literal">" layer to be asked. Press Esc to finish.."</span>;
                    picker.PickObject(message, <span class="highlight-keyword">out</span> drawingObject, <span class="highlight-keyword">out</span> pickedView);
                    <span class="highlight-keyword">if</span> (drawingObject == <span class="highlight-keyword">null</span> || pickedView == <span class="highlight-keyword">null</span> || !(drawingObject <span class="highlight-keyword">is</span> DrawingObject))
                        continuePicking = <span class="highlight-keyword">false</span>;
                    <span class="highlight-keyword">else</span>
                        drawingObjects.Add(drawingObject <span class="highlight-keyword">as</span> DrawingObject);
                }
                <span class="highlight-keyword">catch</span>
                {
                    continuePicking = <span class="highlight-keyword">false</span>;
                }
            }

            <span class="highlight-keyword">if</span> (drawingObjects.Count &gt; <span class="highlight-number">1</span>)
            {
                List&lt;DrawingObject&gt; sortedObjects = <span class="highlight-keyword">new</span> List&lt;DrawingObject&gt;();
                TSD.Operations.Operation.SortObjectsByPresentationOrder(drawingObjects, <span class="highlight-keyword">out</span> sortedObjects);
                <span class="highlight-keyword">if</span> (layers.Count &gt; <span class="highlight-number">0</span>)
                {
                    Console.WriteLine(<span class="highlight-literal">"SortObjectsByPresentationOrder operation successful with "</span> + layers.Count.ToString() + <span class="highlight-literal">" layers.."</span>);
                }
                <span class="highlight-keyword">else</span>
                {
                    Console.WriteLine(<span class="highlight-literal">"SortObjectsByPresentationOrder operation failed.."</span>);
                }
            }
        }
    }
}</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAADBA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID3RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="2172371d-8e05-8a9c-a7cf-e27af89483f0.htm">Operation Class</a></div><div class="seeAlsoStyle"><a href="187b565a-8a45-7656-4b5b-dd1a7b740563.htm">Tekla.Structures.Drawing.Operations Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p>Copyright © 1992-2025 Trimble Solutions Corporation and its licensors. All rights reserved.</p> </div></body></html>