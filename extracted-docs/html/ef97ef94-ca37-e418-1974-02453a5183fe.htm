<html><head><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>MatrixFactory Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="MatrixFactory class" /><meta name="System.Keywords" content="Tekla.Structures.Geometry3d.MatrixFactory class" /><meta name="System.Keywords" content="MatrixFactory class, about MatrixFactory class" /><meta name="Microsoft.Help.F1" content="Tekla.Structures.Geometry3d.MatrixFactory" /><meta name="Microsoft.Help.Id" content="T:Tekla.Structures.Geometry3d.MatrixFactory" /><meta name="Description" content="The MatrixFactory class provides a convenient way to generate different kinds of transformation matrices." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="Tekla.Structures.Geometry3d" /><meta name="file" content="ef97ef94-ca37-e418-1974-02453a5183fe" /><meta name="guid" content="ef97ef94-ca37-e418-1974-02453a5183fe" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">Tekla Open API Reference for Tekla Structures 2025</div><div class="pageBody"><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/logo.png" /></td><td class="titleColumn"><h1>MatrixFactory Class</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            The MatrixFactory class provides a convenient way to generate different
            kinds of transformation matrices.
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="ID0RBSection" class="collapsibleSection"><span class="nolink">System<span id="LSTF8D47172_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF8D47172_0?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</span><br />  <span class="selflink">Tekla.Structures.Geometry3d<span id="LSTF8D47172_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTF8D47172_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>MatrixFactory</span><br /></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="e84e8a9d-9721-ca44-1764-fb8035c9778a.htm">Tekla.Structures.Geometry3d</a><br />
    <strong>Assembly:</strong>
   Tekla.Structures (in Tekla.Structures.dll) Version: 2025.0.0-alpha00048669+a99462f17964bc42624ada6e8d316db2d795d226<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EBCA_tab1" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID1EBCA','cs','1','2');return false;">C#</a></div><div id="ID1EBCA_tab2" class="codeSnippetContainerTab"><a href="#" onclick="javascript:ChangeTab('ID1EBCA','vb','2','2');return false;">VB</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EBCA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EBCA');return false;" title="Copy">Copy</a></div></div><div id="ID1EBCA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">[<span class="identifier">SerializableAttribute</span>]
<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="identifier">MatrixFactory</span></pre></div><div id="ID1EBCA_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve">&lt;<span class="identifier">SerializableAttribute</span>&gt;
<span class="keyword">Public</span> <span class="keyword">NotInheritable</span> <span class="keyword">Class</span> <span class="identifier">MatrixFactory</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EBCA");</script></div><p>The <span class="selflink">MatrixFactory</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="ID3RBSection" class="collapsibleSection"><table class="members" id="methodList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="164a690d-7f09-985b-d7a7-cc0259e6bc53.htm">ByCoordinateSystems</a></td><td><div class="summary">
             Returns a coordinate transformation matrix defined by two coordinate systems.
             With the returned matrix points can be transformed from the first coordinate system to
             the second coordinate system. The ByCoordinateSystems method is meant for transforming
             points between coordinate systems asked in the same work plane.
             </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="eeb1ab4c-20e3-6a13-15f0-a1f5947c8dce.htm">FromCoordinateSystem</a></td><td><div class="summary">
             Returns a coordinate transformation matrix defined by the given coordinate system.
             With the returned matrix points can be transformed from the given coordinate system to
             the current work plane coordinate system.
             </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="9421178e-d986-44f4-f2f4-e2d753bd2fa9.htm">Rotate</a></td><td><div class="summary">
            Returns a rotation matrix in a Clockwise rotation around the given rotation axis,
            defined by the given angle and the given rotation axis.
            </div></td></tr><tr data="public;static;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/static.gif" alt="Static member" title="Static member" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="7dbba383-7bd0-e7a1-c409-9b0e9aa50f36.htm">ToCoordinateSystem</a></td><td><div class="summary">
             Returns a coordinate transformation matrix defined by the given coordinate system.
             With the returned matrix points can be transformed from the current work plane coordinate system
             to the given coordinate system.
             </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID4RBSection" class="collapsibleSection">
            The matrix factory can be used to create some useful transformation
            matrices between different coordinate systems:
            <div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAAABA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">using</span> Tekla.Structures.Geometry3d;
<span class="highlight-keyword">using</span> Tekla.Structures.Model;

<span class="highlight-keyword">public</span> <span class="highlight-keyword">class</span> Example
{
       <span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> Example1()
       {
           Beam Beam1 = <span class="highlight-keyword">new</span> Beam();
           Beam Beam2 = <span class="highlight-keyword">new</span> Beam();
           Point Point1 = <span class="highlight-keyword">new</span> Point();

           CoordinateSystem Csys1 = Beam1.GetCoordinateSystem();
           CoordinateSystem Csys2 = Beam2.GetCoordinateSystem();

           Matrix Matrix = MatrixFactory.ByCoordinateSystems(Csys1, Csys2);
           Point Point2 = Matrix.Transform(Point1);

           <span class="highlight-comment">// The same result for Point2 when using two separate transformations</span>
           Matrix ToCurrentWP = MatrixFactory.FromCoordinateSystem(Csys1);
           Point CurrentPoint = ToCurrentWP.Transform(Point1);

           Matrix ToLocal = MatrixFactory.ToCoordinateSystem(Csys2);
           Point2 = ToLocal.Transform(CurrentPoint);
       }
}</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAAABA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID5RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="e84e8a9d-9721-ca44-1764-fb8035c9778a.htm">Tekla.Structures.Geometry3d Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p>Copyright © 1992-2025 Trimble Solutions Corporation and its licensors. All rights reserved.</p> </div></body></html>